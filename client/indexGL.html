<html>
  <head>
    <title>Worldly Playground</title>
    <style>canvas { width: 100%; height: 100% }</style>
    <script src="js/jquery.min.js"></script>
    <script src="js/canvasGL.js"></script>
    <script src="js/player.js"></script>
    <script>
      var xoff = 0;
      var yoff = 0;
      var zoom = 50000;
      var mapRenderer;
      var ready = function()
      {
        console.log(mapRenderer);
        var la = 44.6488720;
        var lo = -63.5792540;
      }
      $(document).ready(function() {
        mapRenderer = new MapRenderer(ready);
      });
    </script>

  </head>
  <body>
    <!-- <script src="https://raw.github.com/mrdoob/three.js/master/build/three.js"></script> -->
    <script src="js/three.min.js"></script>
    <!--    <script src="https://raw.github.com/mrdoob/three.js/master/build/js/controls/FlyControls.js"></script> -->
    <script>

      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      /*  var controls = new THREE.FirstPersonControls( camera );
       
       controls.movementSpeed = 1000;
       controls.domElement = container;
       controls.rollSpeed = Math.PI / 24;
       controls.autoForward = false;
       controls.dragToLook = false;
       */
      var renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);
      renderer.shadowMapSoft = true;

      var geometry1 = new THREE.CubeGeometry(1, 1, 1);
      //var material1 = new THREE.MeshBasicMaterial({color: 0x000000});
      var material1 = new THREE.MeshLambertMaterial({
        map: THREE.ImageUtils.loadTexture("img/crate.jpg")
      });
      var cube1 = new THREE.Mesh(geometry1, material1);
      cube1.translateX(2);
      cube1.castShadow = true;
      cube1.receiveShadow = true;
      scene.add(cube1);

      var geometry2 = new THREE.CubeGeometry(1, 1, 1);
      //var material2 = new THREE.MeshBasicMaterial({color: 0x00ff00});
      var material2 = new THREE.MeshLambertMaterial({
        map: THREE.ImageUtils.loadTexture("img/asphalt.jpg")
      });
      var cube2 = new THREE.Mesh(geometry2, material2);
      cube2.translateX(-2);
      cube2.castShadow = true;
      cube2.receiveShadow = true;
      scene.add(cube2);

      for (var r = 1; r <= 1; r++)
      {
        var geometry = new THREE.Geometry();
        geometry.vertices.push(new THREE.Vector3(-10, -1, -11 - (10 * r)));
        geometry.vertices.push(new THREE.Vector3(-10, -1, 1 - (10 * r)));
        geometry.vertices.push(new THREE.Vector3(10, -1, 1 - (10 * r)));
        geometry.vertices.push(new THREE.Vector3(10, -1, -11 - (10 * r)));
        geometry.faces.push(new THREE.Face4(0, 1, 2, 3));
        geometry.computeBoundingSphere();
        var asphalt = new THREE.MeshBasicMaterial({color: 0x000000, lineWidth: 10});
        var texture = THREE.ImageUtils.loadTexture("img/asphalt.jpg", {}, function( ) {
          renderer.render(scene);
        });
        //var asphalt = new THREE.MeshBasicMaterial({ map: texture });
        var model = new THREE.Mesh(geometry, asphalt);
        scene.add(model);

        //var line = new THREE.Line(geometry, asphalt);
        //scene.add(line);
      }


      camera.position = {x: 0, y: 0, z: -23};
      //camera.position = {x:4812.5, y:900, z:1109};
      /*
       camera.position.z = 7;
       camera.position.x = 0;
       camera.position.y = 900;
       */
      //camera.lookAt( { x: camera.position.x + 0, y: camera.position.y - 10 , z: camera.position.z } );



      var light = new THREE.AmbientLight(0x404040); // soft white light
      light.castShadow = true;
      light.shadowDarkness = 0.5;
      light.shadowCameraVisible = true;
      scene.add(light);

      var directionalLight = new THREE.DirectionalLight(0xffffff, 1.0);
      directionalLight.position.set(1, 1, 1).normalize();
      directionalLight.castShadow = true;
      directionalLight.shadowDarkness = 1.0;
      directionalLight.shadowCameraVisible = true;
      scene.add(directionalLight);


      /*
       * // Source: http://www.html5canvastutorials.com/webgl/html5-canvas-webgl-ambient-lighting-with-three-js/ 
       // renderer
       var renderer = new THREE.WebGLRenderer();
       renderer.setSize(window.innerWidth, window.innerHeight);
       document.body.appendChild(renderer.domElement);
       
       // camera
       var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
       camera.position.z = 700;
       
       // scene
       var scene = new THREE.Scene();
       
       // material
       var material = new THREE.MeshLambertMaterial({
       color: 0x0000ff
       });
       
       // cube
       var cube = new THREE.Mesh(new THREE.CubeGeometry(300, 300, 300), material);
       cube.overdraw = true;
       scene.add(cube);
       
       // add subtle ambient lighting
       var ambientLight = new THREE.AmbientLight(0x555555);
       scene.add(ambientLight);
       
       // add directional light source
       var directionalLight = new THREE.DirectionalLight(0xffffff);
       directionalLight.position.set(1, 1, 1).normalize();
       scene.add(directionalLight);
       */


      function render() {
        requestAnimationFrame(render);
        renderer.render(scene, camera);
      }
      render();


      //renderer.render( scene, camera );

      /*
       // Code Source: http://stackoverflow.com/questions/4326845/how-can-i-determine-the-direction-of-a-jquery-scroll-event 
       var lastScrollTop = 0;
       $(window).scroll(function(event){
       var st = $(this).scrollTop();
       if (st > lastScrollTop) {
       // downscroll code
       camera.position.z -= 1;
       
       } else {
       // upscroll code
       camera.position.z += 1;
       
       }
       lastScrollTop = st;
       });
       */

    </script>


  </body>
</html>